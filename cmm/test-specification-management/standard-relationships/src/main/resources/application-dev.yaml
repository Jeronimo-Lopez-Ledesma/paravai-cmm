# ============================================================
# ENV / APP METADATA (DEV)
# ============================================================
app:
  environment: DEV

info:
  app:
    name: standard-relationships
    description: Standard Relationships module
    environment: ${app.environment:UNKNOWN}
    version: 1.0.0
    owner: Platform Crew


# ============================================================
# DATA SOURCE (MongoDB) - DEV
# ============================================================
spring:
  data:
    mongodb:
      host: 10.206.14.185
      port: 11046
      database: OPPORTUNITIES
      username: developer
      password: 0dMnPJ1Seb9jZgz540E9
      transaction:
        enabled: true


# ============================================================
# GOVERNANCE / INTERNAL INTEGRATIONS (DEV)
# ============================================================
governance:
  entity-change-tracer:
    base-url: http://10.206.14.185:11036


# ============================================================
# KAFKA (Integration Events Producer) - DEV
# NOTE:
# - Use kebab-case keys because Service Foundation reads them via @Value
# ============================================================
kafka:
  enabled: true
  bootstrapServers: 10.206.14.185:9092

  # Optional (producer tuning)
  producer:
    acks: all
    retries: 3
    client-id: standard-relationships

  # Topic resolution strategy for DomainEventEnvelope publishing
  integration:
    topic-prefix: regulations           # optional prefix for topics
    default-topic: domain-events        # fallback if entityType is missing
    # pattern: "%s.events.%s"           # optional override (default already set in code)


# ============================================================
# OUTBOUND HTTP CLIENT (DEV)
# ============================================================
standards:
  http:
    baseUrl: http://localhost:9099
    connectTimeoutMs: 2000
    responseTimeoutMs: 3000
    readTimeoutMs: 3000
    writeTimeoutMs: 3000
    pool:
      maxConnections: 200
      acquireTimeoutMs: 2000
      maxIdleTimeMs: 30000
      maxLifeTimeMs: 120000


# ============================================================
# RESILIENCE4J (DEV)
# ============================================================
resilience4j:
  bulkhead:
    instances:
      standardsBackend:
        maxConcurrentCalls: 50
        maxWaitDuration: 0

  circuitbreaker:
    instances:
      standardsBackend:
        slidingWindowType: COUNT_BASED
        slidingWindowSize: 20
        minimumNumberOfCalls: 10
        failureRateThreshold: 50
        slowCallRateThreshold: 50
        slowCallDurationThreshold: 2s
        waitDurationInOpenState: 10s
        permittedNumberOfCallsInHalfOpenState: 5

  retry:
    instances:
      standardsBackend:
        maxAttempts: 3
        waitDuration: 200ms
        retryExceptions:
          - java.io.IOException
          - reactor.netty.http.client.PrematureCloseException


# Custom decorator order (used in WebClient config)
resilience:
  order:
    decorators: [bulkhead, circuitbreaker, retry]


# ============================================================
# OBSERVABILITY / ACTUATOR (DEV)
# ============================================================
management:
  endpoints:
    web:
      exposure:
        include: health, info, metrics, beans, env, prometheus
  endpoint:
    health:
      show-details: always


# ============================================================
# LOGGING (DEV)
# ============================================================
logging:
  level:
    root: INFO
    org.springframework.web: INFO
    reactor.netty: INFO
    com.paravai.regulations.standards: DEBUG


# ============================================================
# SERVER (DEV)
# ============================================================
server:
  port: 8096
